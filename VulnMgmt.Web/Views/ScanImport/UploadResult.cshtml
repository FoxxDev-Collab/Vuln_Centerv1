@model VulnMgmt.Web.Models.ViewModels.ScanImportResultViewModel
@{
    ViewData["Title"] = "Import Result";
}

<div class="mb-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb mb-1">
            <li class="breadcrumb-item"><a asp-action="Index">Scan Imports</a></li>
            <li class="breadcrumb-item active">Import Result</li>
        </ol>
    </nav>
    <h1 class="h3">
        @if (Model.Success)
        {
            <i class="bi bi-check-circle text-success me-2"></i>
        }
        else
        {
            <i class="bi bi-x-circle text-danger me-2"></i>
        }
        Import Result
    </h1>
</div>

<div class="row">
    <div class="col-lg-8">
        @if (Model.Success)
        {
            <div class="alert alert-success">
                <i class="bi bi-check-circle me-2"></i>
                @Model.Message
            </div>
        }
        else
        {
            <div class="alert alert-danger">
                <i class="bi bi-exclamation-triangle me-2"></i>
                Import failed. Please check the errors below.
            </div>
        }

        <div class="card mb-4">
            <div class="card-header">
                <i class="bi bi-bar-chart me-2"></i>Import Summary
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-md-3 col-6 mb-3">
                        <div class="border rounded p-3">
                            <div class="h2 mb-0 text-primary">@Model.TotalRows.ToString("N0")</div>
                            <small class="text-muted">Total Rows</small>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="border rounded p-3">
                            <div class="h2 mb-0 text-success">@Model.VulnerabilitiesImported.ToString("N0")</div>
                            <small class="text-muted">New Vulns</small>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="border rounded p-3">
                            <div class="h2 mb-0 text-info">@Model.VulnerabilitiesUpdated.ToString("N0")</div>
                            <small class="text-muted">Updated Vulns</small>
                        </div>
                    </div>
                    <div class="col-md-3 col-6 mb-3">
                        <div class="border rounded p-3">
                            <div class="h2 mb-0 text-secondary">@Model.VulnerabilitiesSkipped.ToString("N0")</div>
                            <small class="text-muted">Skipped</small>
                        </div>
                    </div>
                </div>

                <hr />

                <div class="row">
                    <div class="col-md-6">
                        <dl class="row mb-0">
                            <dt class="col-sm-5">File Name</dt>
                            <dd class="col-sm-7">@Model.FileName</dd>

                            <dt class="col-sm-5">Target Site</dt>
                            <dd class="col-sm-7">@Model.SiteName</dd>

                            <dt class="col-sm-5">Processing Time</dt>
                            <dd class="col-sm-7">@Model.ProcessingTime.TotalSeconds.ToString("F2") seconds</dd>
                        </dl>
                    </div>
                    <div class="col-md-6">
                        <dl class="row mb-0">
                            <dt class="col-sm-5">Hosts Created</dt>
                            <dd class="col-sm-7"><span class="badge bg-success">@Model.HostsCreated</span></dd>

                            <dt class="col-sm-5">Hosts Updated</dt>
                            <dd class="col-sm-7"><span class="badge bg-info">@Model.HostsUpdated</span></dd>
                        </dl>
                    </div>
                </div>
            </div>
        </div>

        @if (Model.Errors.Any())
        {
            <div class="card mb-4 border-danger">
                <div class="card-header bg-danger text-white">
                    <i class="bi bi-exclamation-circle me-2"></i>Errors (@Model.Errors.Count)
                </div>
                <div class="card-body">
                    <ul class="mb-0">
                        @foreach (var error in Model.Errors)
                        {
                            <li class="text-danger">@error</li>
                        }
                    </ul>
                </div>
            </div>
        }

        @if (Model.Warnings.Any())
        {
            <div class="card mb-4 border-warning">
                <div class="card-header bg-warning text-dark">
                    <i class="bi bi-exclamation-triangle me-2"></i>Warnings (@Model.Warnings.Count)
                </div>
                <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                    <ul class="mb-0 small">
                        @foreach (var warning in Model.Warnings.Take(100))
                        {
                            <li class="text-warning">@warning</li>
                        }
                        @if (Model.Warnings.Count > 100)
                        {
                            <li class="text-muted">... and @(Model.Warnings.Count - 100) more warnings</li>
                        }
                    </ul>
                </div>
            </div>
        }

        <div class="d-flex gap-2">
            <a asp-action="Upload" class="btn btn-primary">
                <i class="bi bi-upload me-2"></i>Import Another File
            </a>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="bi bi-list me-2"></i>View All Imports
            </a>
            @if (Model.Success)
            {
                <a asp-controller="Vulnerability" asp-action="Index" class="btn btn-outline-info">
                    <i class="bi bi-bug me-2"></i>View Vulnerabilities
                </a>
            }
        </div>
    </div>
</div>
