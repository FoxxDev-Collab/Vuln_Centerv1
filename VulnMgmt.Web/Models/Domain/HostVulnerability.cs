using System.ComponentModel.DataAnnotations;

namespace VulnMgmt.Web.Models.Domain;

public class HostVulnerability
{
    public int Id { get; set; }

    public int HostId { get; set; }

    public int PluginId { get; set; }

    [StringLength(500)]
    public string? PluginName { get; set; }

    [StringLength(200)]
    public string? Family { get; set; }

    public Severity Severity { get; set; } = Severity.Info;

    [StringLength(45)]
    public string? IPAddress { get; set; }

    [StringLength(20)]
    public string? Protocol { get; set; }

    public int? Port { get; set; }

    [StringLength(17)]
    public string? MACAddress { get; set; }

    public bool IsExploitable { get; set; }

    [StringLength(500)]
    public string? ExploitFrameworks { get; set; }

    [StringLength(100)]
    public string? ExploitEase { get; set; }

    [StringLength(500)]
    public string? CVE { get; set; }

    public DateTime? VulnPublicationDate { get; set; }

    [StringLength(1000)]
    public string? Synopsis { get; set; }

    public string? Description { get; set; }

    public string? Solution { get; set; }

    public string? SeeAlso { get; set; }

    public string? PluginText { get; set; }

    [StringLength(200)]
    public string? Repository { get; set; }

    public DateTime? FirstDiscovered { get; set; }

    public DateTime? LastObserved { get; set; }

    public RemediationStatus RemediationStatus { get; set; } = RemediationStatus.Open;

    public string? RemediationNotes { get; set; }

    public DateTime? RemediationDate { get; set; }

    public DateTime ImportedDate { get; set; } = DateTime.UtcNow;

    [StringLength(500)]
    public string? ImportSource { get; set; }

    public DateTime CreatedDate { get; set; } = DateTime.UtcNow;

    public DateTime ModifiedDate { get; set; } = DateTime.UtcNow;

    // Navigation properties
    public virtual Host Host { get; set; } = null!;
}
